# databases
1. Εισαγωγή
Έστω η ΒΔ ενός τοπικού ερασιτεχνικού ποδοσφαιρικού συλλόγου στην οποία διατηρούνται πληροφορίες
συμμετοχής των μελών του σε διάφορες αθλητικές εκδηλώσεις. Οι πληροφορίες αφορούν τους παίκτες,
τους προπονητές, τις ομάδες, τους αγώνες-πρόγραμμα αγώνων κλπ. Πιο συγκεκριμένα:
• Παίκτες: Για τους παίκτες διατηρούνται πληροφορίες οι οποίες αφορούν το όνομα, επώνυμο, την
ομάδα στην οποία ανήκουν, τη θέση στην οποία παίζουν (center back, goal keeper, defender,
Center Back, Sweeper/Libero, Right Back, Left Back, κλπ.). Επιπλέον για κάθε παίκτη διατηρούνται
συνολικά στατιστικά του με τις κάρτες που έχει λάβει (κίτρινες, κόκκινες κλπ.) καθώς και το
συνολικό αριθμό από γκολ που έχει βάλει, συνολικά λεπτά που ήταν ενεργός στον αγώνα κλπ. Το
όνομα και το επώνυμο μπορούν να λάβουν μόνον έως 10 χαρακτήρες ελληνικά με πλήρη στίξη
(τόνους, διαλυτικά, κλπ.). Δεν θα πρέπει να περιλαμβάνονται περισσότεροι από 11 παίκτες σε κάθε
ομάδα. Υπάρχουν και μεταγραφές, κατά συνέπεια ένας παίκτης δεν ανήκει για όλα τα χρόνια στην
ίδια ομάδα.
• Προπονητές: Προπονητές στο σύλλογο μπορούν να γίνουν μόνον παλιοί παίκτες του συλλόγου.
Οπότε για τους προπονητές διατηρούνται όλες οι πληροφορίες όπως και για τους παίκτες επιπλέον
της προπονητικής τους ιδιότητας στην όποια ομάδα του συλλόγου.
• Ομάδες: Για τις ομάδες διατηρούνται πληροφορίες οι οποίες αφορούν το όνομα τους, το γήπεδο
της έδρας της, κάποια περιγραφή της ιστορίας τους, καθώς και διάφορα στατιστικά όπως: νίκες
εντός/εκτός έδρας, ήττες εντός/εκτός έδρας, ισοπαλίες εντός/εκτός έδρας.
• Αγώνες/πρόγραμμα αγώνων: Για κάθε αγώνα διατηρούνται πληροφορίες όπως ποια είναι η
γηπεδούχος και ποια η φιλοξενούμενη ομάδα, ποιο το σκορ της κάθε ομάδας, ποια η ημερομηνία
που έγινε ο αγώνας. Επιπλέον θα πρέπει να γίνεται έλεγχος ώστε να μην προγραμματίζονται
αγώνες με τις ίδιες ομάδες την ίδια μέρα. Για κάθε ομάδα θα πρέπει να υπάρχει διάστημα 10
ημερών μεταξύ των αγώνων της. Για κάθε αγώνα και για κάθε παίκτη διατηρούνται πληροφορίες
όπως τα γκολ που μπήκαν, τα γκολ που ακυρώθηκαν, οι κάρτες (κόκκινες και κίτρινες) που δέχτηκε
ένας παίκτης, τα πέναλτι, τα κόρνερ (και σε όλα αυτά, η χρονική στιγμή που συνέβησαν).
Ερώτημα 1 (40%). Σχεσιακή Βάση Δεδομένων
a. Με βάση τα παραπάνω στοιχεία, σχεδιάστε το σχεσιακό σχήμα της ΒΔ, υλοποιήστε το
(εντολές CREATE TABLE) στο ΣΔΒΔ PostgreSQL και φορτώστε με δεδομένα τους πίνακες.
Ενδεχομένως να χρειαστεί να υλοποιήσετε επιπλέον βοηθητικούς πίνακες, σε σχέση με
αυτούς οι οποίοι περιγράφονται στην εισαγωγή. Επιπλέον, καλείστε να τεκμηριώσετε τους
περιορισμούς ακεραιότητας των πινάκων (και να δηλώσετε τυχόν περιορισμούς που
προκύπτουν από την εκφώνηση αλλά δεν μπορέσατε να υποστηρίξετε μέσα από τους
περιορισμούς ακεραιότητας των πινάκων). Το παραδοτέο του υποερωτήματος είναι το
σχεσιακό σχήμα της ΒΔ, οι εντολές CREATE TABLE και τα αρχεία τα οποία θα εισάγετε
στους πίνακες. Οδηγία: για την ευκολότερη παραγωγή αληθοφανών δεδομένων
προτείνεται να χρησιμοποιήσετε κάποιο εργαλείο παραγωγής δεδομένων (data generator)
(π.χ. www.mockaroo.com, https://faker.readthedocs.io/en/master/,
https://devskiller.github.io/jfairy/).
b. Εφαρμόστε τη θεωρία της κανονικοποίησης πάνω στο σχεσιακό σχήμα της ΒΔ που
σχεδιάσατε και ελέγξτε τον κάθε πίνακα εάν ακολουθεί την BCNF. Σε αντίθετη περίπτωση,
αποσυνθέστε τους προβληματικούς πίνακες ώστε όλη η ΒΔ να είναι σε BCNF. (Αφαιρείται
από την εκφώνηση)
c. Πάνω στο τελικό σχήμα της ΒΔ υλοποιήστε 2 προβολές/όψεις (views):
• Πρόγραμμα-αγώνων. Μια προβολή που θα αφορά μια συγκεκριμένη ημερομηνία
(π.χ. 30/5/2023) και θα περιλαμβάνει τις «δυναμικές» πληροφορίες των αγώνων
εκείνης της ημέρας: τόπος διεξαγωγής αγώνα, χρόνος, ποιες ομάδες συμμετέχουν,
ποιο το σκορ, ποιοι παίκτες από κάθε ομάδα (όνομα θέση, στο παιχνίδι, χρόνος
συμμετοχής στο παιχνίδι, τις κάρτες που τυχόν χρεώθηκε, τα γκολ που έβαλε και πότε
τα έβαλε).
• Ετήσιο πρωτάθλημα αγώνων. Μια προβολή που θα αφορά μια συγκεκριμένη
αγωνιστική σεζόν (π.χ. 1/9/2022 – 30/6/2023) και θα περιλαμβάνει τις «στατικές»
πληροφορίες των αγώνων εκείνου του διαστήματος: τόπος διεξαγωγής αγώνα,
χρόνος, ποιες ομάδες συμμετέχουν, ποιο το σκορ μεταξύ τους, ποια ομάδα είναι
εντός/εκτός έδρας.
Ερώτημα 2 (20%). Εκτελέστε τις παρακάτω ερωτήσεις (queries) στη ΒΔ (εντολές SELECT).
a) Ποιος είναι προπονητής μιας συγκεκριμένης ομάδας σε συγκεκριμένο αγώνα;
b) Τα γκολ, πέναλτι που έγιναν σε συγκεκριμένο αγώνα, ποια χρονική στιγμή και από
ποιόν παίκτη.
c) Την αγωνιστική εικόνα ενός συγκεκριμένου παίκτη για μια αγωνιστική σεζόν:
γκολ, πέναλτι, κάρτες, λεπτά αγώνα, θέση που έπαιξε.
d) Την αγωνιστική εικόνα μιας συγκεκριμένης ομάδας για μια αγωνιστική σεζόν: σε
πόσους αγώνες συμμετείχε, σε πόσους ήταν γηπεδούχος και σε πόσους
φιλοξενούμενη, πόσες ήττες /νίκες/ ισοπαλίες, πόσες φορές νίκησε/ έχασε/ έφερε
ισοπαλία εντός/ εκτός έδρας.
Ερώτημα 3 (20%). Υλοποίηση triggers, cursors
a. Φτιάξτε έναν trigger ο οποίος κρατά/γεμίζει ένα πίνακα-ιστορικό. Όταν διαγράφονται με
επιτυχία γραμμές από τον πίνακα ομάδες (π.χ. διαγράφονται όλες οι ομάδες οι οποίες δεν
πέτυχαν καμία νίκη μέσα στο έτος) τότε οι διαγραμμένες γραμμές εισάγονται αυτόματα
στον πίνακα ομάδες-υποβιβασμός-κατηγορίας.
b. Βρείτε για κάθε παίκτη ομαδοποιημένα ανά χρονικά διαστήματα και ανά ομάδα και ανά
αγώνα τα: γκολ, πέναλτι, κάρτες, λεπτά αγώνα, θέση που έπαιξε. Χρησιμοποιείστε cursors
ώστε να εμφανίσετε τις γραμμές σε ομάδες των 10.
Ερώτημα 4 (20%). Σύνδεση ΒΔ με Application Programming Interface (API)
Υλοποιήστε προγραμματιστικά έναν client σε οποιαδήποτε γλώσσα προγραμματισμού γνωρίζετε
(π.χ. Python, Java, C) χρησιμοποιώντας την κατάλληλη βιβλιοθήκη σύνδεσης με την PostgreSQL
(π.χ. psycopg2, JDBC, ODBC). Ο client θα συνδέεται στο ΣΔΒΔ της PostgreSQL, θα εκτελεί τα
queries του Ερωτήματος 2, και θα εμφανίζει τα αποτελέσματα στον χρήστη (είτε σε terminal είτε
με γραφικά).
